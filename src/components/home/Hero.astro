---
/**
 * src/components/home/Hero.astro
 * Hero "Prime" Component
 */
import ActionBase from '@components/common/actions/ActionBase.astro';
import ActionIcon from '@components/common/actions/ActionIcon.astro';
import WhatsAppButton from '@components/ui/WhatsAppButton.tsx';
import type { HeroData } from '@/interfaces/ui/sections/landing-page.interface';

// Import local avatars
import avatar1 from '@images/hero/avatar1.png';
import avatar2 from '@images/hero/avatar2.png';
import avatar3 from '@images/hero/avatar3.png';

// Import consolidated Premium styles
import '@/styles/components/_hero.scss';

interface Props {
	data: HeroData;
}

const { data } = Astro.props;
---

<section class="hero-prime" id="hero-prime" role="region" aria-labelledby="hero-title">
	<!-- 1. Background Layer -->
	<div class="hero-prime__bg parallax-bg">
		<!-- Priority Image (Lazy load off for LCP) -->
		<img
			src={data.backgroundImage.desktopUrl}
			alt="Experiencia de lujo en invitaciones digitales para eventos exclusivos"
			class="hero-bg-img"
			fetchpriority="high"
		/>

		{data.backgroundImage.videoUrl && (
			<video
				autoplay
				loop
				muted
				playsinline
				poster={data.backgroundImage.desktopUrl}
				class="hero-bg-video"
			>
				<source src={data.backgroundImage.videoUrl} type="video/webm" />
				<source src={data.backgroundImage.videoUrl.replace('.webm', '.mp4')} type="video/mp4" />
			</video>
		)}
	</div>

	<!-- 2. Overlay Layer -->
	<div class="hero-prime__overlay"></div>

	<!-- 3. Content Layer -->
	<div class="hero-prime__content">
		<!-- Title (Stagger 1) -->
		<h1 class="hero-prime__title stagger-1" id="hero-title">
			{data.title}
		</h1>

		<!-- Subtitle (Stagger 2) -->
		<p class="hero-prime__subtitle stagger-2">
			{data.subtitle}
		</p>

		<!-- Actions (Stagger 3) -->
		<div class="hero-prime__actions stagger-3">
			<WhatsAppButton client:idle className="shine-effect" />
			<ActionBase as="a" href={data.secondaryCtaUrl || '#'} variant="outline" color="white" class="shine-effect">
				{data.secondaryCtaLabel}
			</ActionBase>
		</div>

		<!-- Social Proof (Optional) -->
		{data.socialProofText && (
			<div class="hero-prime__social-proof stagger-3">
				<div class="avatars">
					<img src={avatar1.src} alt="Usuario de Celebra-me" />
					<img src={avatar2.src} alt="Usuario de Celebra-me" />
					<img src={avatar3.src} alt="Usuario de Celebra-me" />
				</div>
				<span>{data.socialProofText}</span>
			</div>
		)}
	</div>

	<!-- Scroll Indicator -->
	<div class="hero-prime__scroll-indicator">
		<ActionIcon
			icon="ArrowDownIcon"
			variant="scroll"
			color="white"
			as="a"
			href="#services-section"
			title="Descubre mÃ¡s"
		/>
	</div>
</section>

<script>
	// 1. Mouse Move Parallax Effect
	const hero = document.getElementById('hero-prime');
	const bg = hero?.querySelector('.parallax-bg');

	if (hero && bg) {
		hero.addEventListener('mousemove', (e) => {
			const { clientX, clientY } = e;
			const { innerWidth, innerHeight } = window;

			// Calculate movement (subtle)
			const moveX = (clientX - innerWidth / 2) / 50;
			const moveY = (clientY - innerHeight / 2) / 50;

			// Apply transform to the image/video within the bg div
			const media = bg.querySelectorAll('img, video');
			media.forEach((el) => {
				(el as HTMLElement).style.transform = `scale(1.1) translate(${moveX}px, ${moveY}px)`;
			});
		});

		// Reset on mouse leave
		hero.addEventListener('mouseleave', () => {
			const media = bg.querySelectorAll('img, video');
			media.forEach((el) => {
				(el as HTMLElement).style.transform = `scale(1.1) translate(0, 0)`;
			});
		});
	}
</script>
