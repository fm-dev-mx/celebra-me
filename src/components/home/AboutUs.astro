---
// src/components/home/AboutUs.astro
import Container from '@components/layout/Container.astro';
import Section from '@components/layout/Section.astro';
import OptimizedImage from '@components/common/OptimizedImage.astro';
import ActionBase from '@components/common/actions/ActionBase.astro';
import ActionIcon from '@components/common/actions/ActionIcon.astro';
// import type { IconNames } from '@/core/types/ui/iconNames.type';
import Icon from '@components/common/icons/AppIcon.astro';
import partyToastImage from '@images/about/partyToastPremium.png';
import type { AboutData } from '@/interfaces/ui/sections/landing-page.interface';

// Import stylesheet
import '@/styles/home/_about-us.scss';

interface Props {
	data: AboutData;
}

const { data } = Astro.props;
---

<Section id="nosotros" class="about-us">
	<div class="about-us__bg-overlay"></div>

	<Container class="about-us__container">
		<div class="about-us__grid">
			{/* Content Side */}
			<div class="about-us__content">
				<header
					class="about-us__header animate-on-scroll"
					style="--animation-delay: 100ms"
				>
					<h2 class="about-us__title">{data.title}</h2>
					<div class="about-us__underline"></div>
				</header>

				<p
					class="about-us__description animate-on-scroll"
					style="--animation-delay: 300ms"
				>
					{data.description}
				</p>

				<div
					class="about-us__actions animate-on-scroll"
					style="--animation-delay: 500ms"
				>
					<ActionBase
						variant="outline"
						color="primary"
						as="a"
						href={data.cta.href}
						class="about-us__cta"
					>
						{data.cta.label}
						<Icon name="ArrowRight" class="about-us__cta-icon" />
					</ActionBase>
				</div>
			</div>

			<div
				class="about-us__visual animate-on-scroll"
				style="--animation-delay: 200ms"
			>
				<div class="about-us__image-wrapper">
					<div class="about-us__image-frame"></div>
					<OptimizedImage
						imagePath={partyToastImage}
						alt="CelebraciÃ³n elegante con brindis"
						width={800}
						height={1000}
						class="about-us__image"
					/>
					<div class="about-us__image-glow"></div>
					<div class="about-us__image-decoration"></div>
				</div>
			</div>
		</div>

		{/* Values Grid */}
		<div class="about-us__values">
			{data.values.map((value, index) => (
				<div
					class="about-us__value-card animate-on-scroll"
					style={`--animation-delay: ${(index + 4) * 150}ms`}
				>
					<div class="about-us__value-icon-wrapper">
						<Icon name={value.icon} class="about-us__value-icon" />
					</div>
					<h3 class="about-us__value-title">{value.name}</h3>
					<p class="about-us__value-description">{value.description}</p>
				</div>
			))}
		</div>
	</Container>

	{/* Scroll Indicator */}
	<div class="about-us__scroll-indicator">
		<ActionIcon
			icon="ArrowDownIcon"
			variant="scroll"
			color="primary"
			as="a"
			href="#servicios"
			title="Explorar servicios"
		/>
	</div>
</Section>

<script>
	const observerOptions = {
		root: null,
		rootMargin: '-5% 0px',
		threshold: 0.15
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach((entry) => {
			if (entry.isIntersecting) {
				const target = entry.target;
				target.classList.add('is-visible');

				// Optional: add performance hint
				if (target instanceof HTMLElement) {
					target.style.willChange = 'opacity, transform, filter';
				}

				// stop observing once visible for better performance
				observer.unobserve(target);

				// Clean up performance hint after animation ends
				setTimeout(() => {
					if (target instanceof HTMLElement) {
						target.style.willChange = 'auto';
					}
				}, 2000);
			}
		});
	}, observerOptions);

	const animatedElements = document.querySelectorAll('.animate-on-scroll');
	animatedElements.forEach((el) => observer.observe(el));
</script>
