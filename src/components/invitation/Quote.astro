---
// src/components/invitation/Quote.astro
import '@/styles/invitation/_quote.scss';

interface Props {
	text: string;
	author?: string;
}

const { text, author } = Astro.props;
---

<section id="quote-section" class="quote-section">
	<div class="quote-texture" aria-hidden="true"></div>
	<div class="quote-container">
		<div class="quote-divider-top" aria-hidden="true">
			<svg viewBox="0 0 200 40" preserveAspectRatio="xMidYMid meet" fill="none" stroke="currentColor">
				<path d="M10,20 Q50,0 100,20 T190,20" stroke-width="0.5" opacity="0.6"/>
				<path d="M40,20 Q100,10 160,20" stroke-width="1" stroke-linecap="round"/>
				<circle cx="100" cy="15" r="1.5" fill="currentColor"/>
			</svg>
		</div>

		<blockquote class="quote-content">
			{text.split('\n').map((line) => (
				<p class="quote-line">
					{line}
				</p>
			))}
		</blockquote>

		{author && (
			<div class="quote-author-container">
				<div class="quote-ornament" aria-hidden="true"></div>
				<cite class="quote-author">{author}</cite>
				<div class="quote-ornament" aria-hidden="true"></div>
			</div>
		)}

		<div class="quote-divider-bottom" aria-hidden="true">
			<svg viewBox="0 0 200 40" preserveAspectRatio="xMidYMid meet" fill="none" stroke="currentColor">
				<path d="M10,20 Q50,40 100,20 T190,20" stroke-width="0.5" opacity="0.6"/>
				<path d="M40,20 Q100,30 160,20" stroke-width="1" stroke-linecap="round"/>
				<circle cx="100" cy="25" r="1.5" fill="currentColor"/>
			</svg>
		</div>
	</div>
</section>

<script>
	const observerOptions = {
		threshold: 0.2,
		rootMargin: '0px 0px -50px 0px'
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				const lines = entry.target.querySelectorAll('.quote-line');
				lines.forEach((line, index) => {
					setTimeout(() => {
						line.classList.add('is-visible');
					}, index * 400);
				});
				observer.unobserve(entry.target);
			}
		});
	}, observerOptions);

	const quoteSection = document.querySelector('.quote-section');
	if (quoteSection) {
		observer.observe(quoteSection);
	}
</script>

