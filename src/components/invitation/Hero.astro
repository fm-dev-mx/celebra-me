---
// src/components/invitation/Hero.astro
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import type { ImageAsset } from '@/lib/assets/AssetRegistry';
import '@/styles/invitation/_hero.scss';

interface Props {
	name: string;
	label?: string; // New prop for generic label
	nickname?: string;
	date: string;
	time?: string;
	venueName: string;
	backgroundImage: ImageMetadata | ImageAsset;
	portrait?: ImageMetadata | ImageAsset; // ADU-8: Optional celebrant portrait
}

const { name, label, nickname, date, time, venueName, backgroundImage, portrait } = Astro.props;

const bgSrc = 'src' in backgroundImage ? backgroundImage.src : backgroundImage;
const portraitSrc = portrait ? ('src' in portrait ? portrait.src : portrait) : undefined;

const formattedDate = new Date(date).toLocaleDateString('es-MX', {
	day: 'numeric',
	month: 'long',
	year: 'numeric',
});
---

<section id="inicio" class="invitation-hero">
	<div class="invitation-hero__background">
		{
			typeof bgSrc === 'string' ? (
				<Image
					src={bgSrc}
					alt={name}
					width={1920}
					height={1080}
					format="webp"
					quality={80}
					loading="eager"
					fetchpriority="high"
				/>
			) : (
				<Image
					src={bgSrc}
					alt={name}
					width={1920}
					height={1080}
					format="webp"
					quality={80}
					loading="eager"
					fetchpriority="high"
				/>
			)
		}
	</div>

	<div class="invitation-hero__content">
		{label && <span class="invitation-hero__label">{label}</span>}
		<h1 class="invitation-hero__title">{name}</h1>

		{nickname && (
			<div class="invitation-hero__nickname-badge">
				<span>{nickname}</span>
			</div>
		)}

		{portraitSrc && (
			<div class="invitation-hero__portrait">
				{typeof portraitSrc === 'string' ? (
					<Image
						src={portraitSrc}
						alt={`Retrato de ${name}`}
						width={200}
						height={200}
						format="webp"
						quality={85}
					/>
				) : (
					<Image
						src={portraitSrc}
						alt={`Retrato de ${name}`}
						width={200}
						height={200}
						format="webp"
						quality={85}
					/>
				)}
			</div>
		)}

		<div class="invitation-hero__divider"></div>

		<div class="invitation-hero__details">
			<p class="invitation-hero__date">{formattedDate}</p>
			{time && <p class="invitation-hero__time">{time}</p>}
			<p class="invitation-hero__venue">
				<span class="calligraphy-accent">en</span> {venueName}
			</p>
		</div>
	</div>

	<div class="invitation-hero__scroll-indicator">
		<span class="invitation-hero__scroll-text">Desliza</span>
		<div class="invitation-hero__scroll-chevron">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
				<path d="m6 9 6 6 6-6"/>
			</svg>
		</div>
	</div>
</section>
