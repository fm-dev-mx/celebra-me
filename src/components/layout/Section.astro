---
import type { ImageMetadata } from 'astro';
interface Props {
	id?: string;
	backgroundImageDesktop?: string | ImageMetadata;
	backgroundImageMobile?: string | ImageMetadata;
	padding?: string;
	relative?: string;
	fullWidth?: boolean;
	fullHeight?: boolean;
	backgroundEffect?: string;
	class?: string;
}

const {
	id,
	backgroundImageDesktop,
	backgroundImageMobile,
	padding = 'py-10',
	relative = '',
	fullWidth = false,
	fullHeight = false,
	backgroundEffect,
	class: className,
} = Astro.props;

// Helper to get URL from string or ImageMetadata
const getBgUrl = (bg?: string | ImageMetadata) => {
	if (!bg) return '';
	if (typeof bg === 'string') return `url(${bg})`;
	return `url(${bg.src})`;
};

const desktopBgStyle = backgroundImageDesktop ? getBgUrl(backgroundImageDesktop) : 'none';
const mobileBgStyle = backgroundImageMobile ? getBgUrl(backgroundImageMobile) : 'none';
---

<section
	id={id}
	class:list={[padding, relative, { 'w-full': fullWidth, 'h-full': fullHeight }, className]}
>
	{backgroundEffect && <div class={backgroundEffect} />}
	<style define:vars={{ desktopBgStyle, mobileBgStyle }}>
		section {
			background-image: var(--desktopBgStyle);
		}
		@media (max-width: 640px) {
			section {
				background-image: var(--mobileBgStyle) !important;
			}
		}
	</style>
	<slot />
</section>
