---
// src/components/xv/Quote.astro
// Elegant quote/dedication section for XV AÃ±os invitations

import '@/styles/xv/_quote.scss';

interface Props {
	text: string;
	author?: string;
}

const { text, author } = Astro.props;
---

<section id="quote-section" class="quote-section">
	<div class="quote-texture" aria-hidden="true"></div>
	<div class="quote-container">
		<div class="quote-divider-top" aria-hidden="true">
			<svg viewBox="0 0 100 20" preserveAspectRatio="none">
				<path d="M0,10 Q25,0 50,10 T100,10" fill="none" stroke="currentColor" stroke-width="0.5"></path>
			</svg>
		</div>

		<blockquote class="quote-content">
			{text.split('\n').map((line) => (
				<p class="quote-line">
					{line}
				</p>
			))}
		</blockquote>

		{author && (
			<div class="quote-author-container">
				<div class="quote-ornament" aria-hidden="true"></div>
				<cite class="quote-author">{author}</cite>
				<div class="quote-ornament" aria-hidden="true"></div>
			</div>
		)}

		<div class="quote-divider-bottom" aria-hidden="true">
			<svg viewBox="0 0 100 20" preserveAspectRatio="none">
				<path d="M0,10 Q25,20 50,10 T100,10" fill="none" stroke="currentColor" stroke-width="0.5"></path>
			</svg>
		</div>
	</div>
</section>

<script>
	const observerOptions = {
		threshold: 0.2,
		rootMargin: '0px 0px -50px 0px'
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				const lines = entry.target.querySelectorAll('.quote-line');
				lines.forEach((line, index) => {
					setTimeout(() => {
						line.classList.add('is-visible');
					}, index * 400);
				});
				observer.unobserve(entry.target);
			}
		});
	}, observerOptions);

	const quoteSection = document.querySelector('.quote-section');
	if (quoteSection) {
		observer.observe(quoteSection);
	}
</script>

