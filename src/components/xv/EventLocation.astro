---
/*
  EventLocation Component for XV Invitations
  Displays two modern, interactive cards for the event venues:
  - Ceremony (Church)
  - Reception (Party Hall)

  Itinerary is now integrated into the Reception card for a seamless design.
  Data-driven: All content comes from props (Content Collection JSON).
*/
import '@/styles/xv/_event-location.scss';
import '@/styles/xv/_section-nav-button.scss';
import SectionNavButton from '@/components/xv/components/SectionNavButton.astro';
import CrownIcon from '@/components/xv/icons/CrownIcon.astro';
import EnvelopedIcon from '@/components/xv/icons/EnvelopedIcon.astro';
import ForbiddenIcon from '@/components/xv/icons/ForbiddenIcon.astro';
import WaltzIcon from '@/components/xv/icons/WaltzIcon.astro';
import DinnerIcon from '@/components/xv/icons/DinnerIcon.astro';
import ToastIcon from '@/components/xv/icons/ToastIcon.astro';

interface VenueData {
	venueName: string;
	address: string;
	date: string;
	time: string;
	mapUrl?: string;
	image?: string;
}

interface ItineraryItem {
	icon: 'waltz' | 'dinner' | 'toast' | 'cake' | 'party';
	label: string;
	time: string;
}

interface Indication {
	icon: 'crown' | 'envelope' | 'forbidden' | 'dress' | 'gift';
	text: string;
}

interface Props {
	ceremony?: VenueData;
	reception?: VenueData & { itinerary?: ItineraryItem[] };
	indications?: Indication[];
}

const { ceremony, reception, indications } = Astro.props;

// Map icon names to components
const iconMap = {
	waltz: WaltzIcon,
	dinner: DinnerIcon,
	toast: ToastIcon,
	cake: DinnerIcon, // Fallback
	party: ToastIcon, // Fallback
	crown: CrownIcon,
	envelope: EnvelopedIcon,
	forbidden: ForbiddenIcon,
	dress: CrownIcon, // Fallback
	gift: EnvelopedIcon, // Fallback
};
---

<section class="event-location" id="event-location">
	<div class="event-location__container">
		{ceremony && (
			<div class="event-location__card-wrapper">
				<h3 class="event-location__card-title">Ceremonia</h3>
				<article class="event-location__card event-location__card--ceremony">
					<div class="event-location__card-image-container">
						<img
							src={ceremony.image || ''}
							alt={ceremony.venueName}
							class="event-location__card-image"
						/>
					</div>
					<div class="event-location__card-content">
						<ul class="event-location__card-content-list">
							<li class="event-location__card-content-list__place">
								{ceremony.venueName}
							</li>
							<li class="event-location__card-content-list__date">
								{ceremony.date}
							</li>
							<li class="event-location__card-content-list__hour">{ceremony.time}</li>
							<li class="event-location__card-content-list__address">
								{ceremony.address}
							</li>
						</ul>
						{ceremony.mapUrl && (
							<a
								href={ceremony.mapUrl}
								class="event-location__card-content-button"
								target="_blank"
								rel="noopener noreferrer"
								title="Click to view location on Google Maps"
							>
								Cómo llegar
							</a>
						)}
					</div>
				</article>
			</div>
		)}

		{reception && (
			<div class="event-location__card-wrapper">
				<h3 class="event-location__card-title">Recepción</h3>
				<article class="event-location__card event-location__card--reception">
					<div class="event-location__card-image-container">
						<img
							src={reception.image || ''}
							alt={reception.venueName}
							class="event-location__card-image"
						/>
					</div>
					<div class="event-location__card-content">
						<ul class="event-location__card-content-list">
							<li class="event-location__card-content-list__place">
								{reception.venueName}
							</li>
							<li class="event-location__card-content-list__date">
								{reception.date}
							</li>
							<li class="event-location__card-content-list__hour">{reception.time}</li>
							<li class="event-location__card-content-list__address">
								{reception.address}
							</li>
						</ul>

						{reception.itinerary && reception.itinerary.length > 0 && (
							<div class="event-location__card-content-itinerary">
								<ul class="event-location__card-content-itinerary-list">
									{reception.itinerary.map((item) => {
										const IconComponent = iconMap[item.icon] || WaltzIcon;
										return (
											<li class="event-location__card-content-itinerary-list-item">
												<span class="event-location__card-content-itinerary-icon">
													<IconComponent />
												</span>
												<span class="event-location__card-content-itinerary-label">
													{item.label}
												</span>
												<span class="event-location__card-content-itinerary-time">
													{item.time}
												</span>
											</li>
										);
									})}
								</ul>
							</div>
						)}

						{reception.mapUrl && (
							<a
								href={reception.mapUrl}
								class="event-location__card-content-button"
								target="_blank"
								rel="noopener noreferrer"
								title="Click to view location on Google Maps"
							>
								Cómo llegar
							</a>
						)}
					</div>
				</article>
			</div>
		)}
	</div>

	{indications && indications.length > 0 && (
		<div class="event-location__indications-container">
			<div class="event-location__divider" aria-hidden="true"></div>

			<div class="event-location__indications">
				{indications.map((indication) => {
					const IconComponent = iconMap[indication.icon] || CrownIcon;
					return (
						<div class="indication-item">
							<div class="indication-icon">
								<IconComponent />
							</div>
							<p>{indication.text}</p>
						</div>
					);
				})}
			</div>
		</div>
	)}

	<div class="nav-button-container">
		<SectionNavButton href="#rsvp-section" class="event-location" section="Padres y Padrinos" />
	</div>
</section>
