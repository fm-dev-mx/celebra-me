---
// src/pages/index.astro
import Layout from '@/layouts/Layout.astro';
import Hero from '@/components/home/Hero.astro';
import Services from '@/components/home/Services.astro';
import AboutUs from '@/components/home/AboutUs.astro';
import Testimonials from '@/components/home/Testimonials.astro';
import Pricing from '@/components/home/Pricing.astro';
import FAQ from '@/components/home/FAQ.astro';
import Contact from '@/components/home/Contact.astro';
import Footer from '@/components/home/Footer.astro';
import { landingData, footerData } from '@/data/landing-page.data';

---

<Layout title="Celebra.me | Invitaciones Digitales Premium">
	<style is:global>
		html {
			scroll-snap-type: y mandatory;
			scroll-behavior: smooth;
		}

		section, .hero-prime, footer {
			scroll-snap-align: start;
			scroll-snap-stop: always;
			min-height: 100vh;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}

		/* Footer doesn't need to be full height if it's small */
		footer {
			min-height: auto;
			scroll-snap-align: end;
		}
	</style>

	<div class="landing-sections-wrapper">
		<Hero data={landingData.hero} />
		<div class="animate-icons"><Services data={landingData.services} /></div>
		<div class="animate-icons"><AboutUs data={landingData.about} /></div>
		<Testimonials data={landingData.testimonials} />
		<Pricing data={landingData.pricing} />
		<FAQ data={landingData.faq} />
		<Contact data={landingData.contact} />
		<Footer data={footerData} />
	</div>

	<script>
		// 1. Global Intersection Observer for Landing Page Sections
		const observerOptions = {
			threshold: 0.1,
			rootMargin: '0px 0px -10% 0px'
		};

		const observer = new IntersectionObserver((entries) => {
			entries.forEach(entry => {
				if (entry.isIntersecting) {
					entry.target.classList.add('is-visible');
				}
			});
		}, observerOptions);

		// Observe all main sections and the wrapper divs
		document.querySelectorAll('section, .hero-prime, .animate-icons').forEach(el => {
			observer.observe(el);
		});

        // 2. Dynamic Scroll-Padding Logic
        // Handles the auto-hiding header (Headroom pattern) to prevent title overlap
        let lastScrollY = window.scrollY;
        const html = document.documentElement;

        // Initial state
        html.style.scrollPaddingTop = '100px';

        window.addEventListener('scroll', () => {
            const currentScrollY = window.scrollY;
            const isScrollingDown = currentScrollY > lastScrollY;

            if (currentScrollY < 100) {
                // Near top: use full header padding
                html.style.scrollPaddingTop = '100px';
            } else {
                // If scrolling down, menu is hidden -> 0 padding
                // If scrolling up, menu appears -> 70px padding
                html.style.scrollPaddingTop = isScrollingDown ? '0px' : '70px';
            }

            lastScrollY = currentScrollY;
        }, { passive: true });
	</script>
</Layout>
