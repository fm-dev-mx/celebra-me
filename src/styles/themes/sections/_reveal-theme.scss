@use 'sass:color';
@use '../../tokens' as tokens;

// ==========================================================================
// LUXURY HACIENDA REVEAL (Envelope & Seal)
// ==========================================================================

.event-theme-wrapper[data-variant='luxury-hacienda'] {
	.envelope-wrapper {
		background:
			radial-gradient(ellipse at 30% 20%, rgba(0, 0, 0, 0.1) 0%, transparent 50%),
			radial-gradient(ellipse at 70% 80%, rgba(0, 0, 0, 0.1) 0%, transparent 50%),
			linear-gradient(105deg, transparent 40%, rgba(0, 0, 0, 0.05) 50%, transparent 60%),
			radial-gradient(
				ellipse at center,
				var(--color-surface-dark) 0%,
				rgba(var(--color-surface-dark-rgb), 0.85) 100%
			);
		background-size:
			200% 200%,
			200% 200%,
			100% 100%,
			auto;
		background-blend-mode: overlay, overlay, overlay, normal;
	}

	.envelope-container {
		width: 100%;
		max-width: 500px;
		aspect-ratio: 4 / 3;
		transform: rotate(-1deg);
	}

	.envelope-base,
	.envelope-pocket,
	.envelope-flap {
		background-color: var(--color-surface-primary) !important;
		background-image:
			radial-gradient(
				circle at 10% 10%,
				rgba(var(--color-surface-dark-rgb), 0.2),
				transparent 40%
			),
			radial-gradient(
				circle at 90% 85%,
				rgba(var(--color-surface-dark-rgb), 0.3),
				transparent 30%
			),
			radial-gradient(
				circle at 70% 20%,
				transparent 20%,
				rgba(var(--color-surface-dark-rgb), 0.1) 21%,
				transparent 23%
			),
			url("data:image/svg+xml,%3Csvg viewBox='0 0 250 250' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='parchment'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.6' numOctaves='4' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3CfeComponentTransfer%3E%3CfeFuncR type='linear' slope='0.1' intercept='0.90'/%3E%3CfeFuncG type='linear' slope='0.1' intercept='0.85'/%3E%3CfeFuncB type='linear' slope='0.1' intercept='0.75'/%3E%3C/feComponentTransfer%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23parchment)'/%3E%3C/svg%3E");
		background-blend-mode: multiply, multiply, multiply, normal;
		border: none !important;

		-webkit-mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' preserveAspectRatio='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='rough'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.2' numOctaves='5'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='3'/%3E%3C/filter%3E%3Crect x='2' y='2' width='96' height='96' filter='url(%23rough)' fill='black'/%3E%3C/svg%3E");
		mask-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' preserveAspectRatio='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='rough'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.2' numOctaves='5'/%3E%3CfeDisplacementMap in='SourceGraphic' scale='3'/%3E%3C/filter%3E%3Crect x='2' y='2' width='96' height='96' filter='url(%23rough)' fill='black'/%3E%3C/svg%3E");
		-webkit-mask-size: 100% 100%;
		mask-size: 100% 100%;
		box-shadow: 2px 4px 15px rgba(0, 0, 0, 0.4) !important;
	}

	.envelope-flap {
		clip-path: none !important;
		height: 49% !important;
		width: 100% !important;
		border-bottom: 3px solid rgba(var(--color-surface-dark-rgb), 0.2) !important;
		box-shadow: inset 0 -10px 20px rgba(0, 0, 0, 0.2) !important;
		z-index: 10;

		&.is-open {
			transform: rotateX(160deg) translateY(-20%) !important;
			z-index: 0;
		}

		.envelope-tooltip {
			right: 140% !important;
			left: auto !important;
			top: 50% !important;
			transform: translateY(-50%) !important;

			&::after {
				top: 50% !important;
				right: -6px !important;
				left: auto !important;
				transform: translateY(-50%) !important;
				border-width: 6px 0 6px 6px !important;
				border-color: transparent transparent transparent rgba(0, 0, 0, 0.5) !important;
			}
		}
	}

	.envelope-pocket {
		clip-path: none !important;
		top: 40% !important;
		height: 60% !important;
		z-index: 2;
		border-top: 2px solid rgba(var(--color-surface-dark-rgb), 0.1) !important;
	}

	.envelope-tease {
		padding: 2.5rem !important;
		display: flex !important;
		flex-direction: column !important;
		justify-content: flex-start !important;
		align-items: flex-start !important;
		text-align: left !important;
		height: 100%;
	}

	.envelope-stamp-area {
		position: absolute;
		top: 15px;
		right: 15px;
		transform: rotate(12deg);
		z-index: 20;

		.envelope-stamp {
			border: 2px double var(--color-action-accent);
			padding: 4px 8px;
			color: var(--color-action-accent);
			font-family: 'Cormorant Garamond', serif;
			display: flex;
			flex-direction: column;
			align-items: center;
			opacity: 0.8;
			filter: contrast(1.5) sepia(0.5);

			span {
				font-weight: 700;
				font-size: 0.8rem;
			}
			small {
				font-size: 0.6rem;
				letter-spacing: 0.2em;
			}
		}
	}

	.tease-header {
		margin-top: 1rem;
		width: 100%;

		.envelope-manifest-label {
			display: block;
			font-family: 'Cormorant Garamond', serif;
			font-size: 0.7rem;
			color: rgba(var(--color-text-primary-rgb), 0.6);
			letter-spacing: 0.3em;
			margin-bottom: 0.5rem;
		}

		.envelope-name {
			font-size: clamp(1.6rem, 6vw, 2.6rem) !important;
			line-height: 1 !important;
			margin: 0 !important;
			background: none !important;
			color: var(--color-text-primary) !important;
			-webkit-text-fill-color: var(--color-text-primary) !important;
			font-family: 'EB Garamond', serif !important;
			font-weight: 800 !important;
			position: relative;

			&::after {
				content: '';
				position: absolute;
				bottom: -5px;
				left: 0;
				width: 60%;
				height: 2px;
				background: rgba(var(--color-text-primary-rgb), 0.2);
			}
		}
	}

	.envelope-tease .envelope-seal-zone {
		position: absolute !important;
		inset: 47% auto auto 50% !important;
		left: 85% !important;
		transform: translate(-50%, -50%) !important;
		z-index: 15 !important;
	}

	.tease-content-bottom {
		margin-top: auto;
		width: 70%;

		.envelope-details {
			font-family: 'Cormorant Garamond', serif;
			font-size: 0.9rem !important;
			color: var(--color-text-primary) !important;
			opacity: 0.9;
		}

		.envelope-microcopy {
			font-family: 'EB Garamond', serif;
			font-style: italic;
			color: rgba(var(--color-text-primary-rgb), 0.7);
			margin-top: 0.5rem;
		}
	}

	.envelope-seal-button {
		filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.45)) drop-shadow(0 4px 6px rgba(0, 0, 0, 0.3))
			drop-shadow(0 10px 20px rgba(0, 0, 0, 0.2)) !important;
		transition: transform 0.3s cubic-bezier(0.23, 1, 0.32, 1) !important;

		&:hover {
			transform: scale(1.08) rotate(2deg) !important;
			filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.5))
				drop-shadow(0 6px 10px rgba(0, 0, 0, 0.3))
				drop-shadow(0 14px 28px rgba(0, 0, 0, 0.15)) !important;
		}

		.seal-visual {
			width: 84px !important;
			height: 84px !important;
			background: radial-gradient(
				circle at 35% 30%,
				color.adjust(tokens.$color-wax-seal, $lightness: 18%) 0%,
				color.adjust(tokens.$color-wax-seal, $lightness: 8%) 20%,
				tokens.$color-wax-seal 55%,
				color.adjust(tokens.$color-wax-seal, $lightness: -20%) 100%
			) !important;
			border: none !important;
			box-shadow:
				inset -3px -4px 8px rgba(0, 0, 0, 0.4),
				inset 3px 4px 8px rgba(255, 255, 255, 0.08),
				inset 0 0 20px rgba(0, 0, 0, 0.15) !important;
			border-radius: 48% 52% 45% 95% / 53% 44% 56% 47% !important;

			&::after {
				content: '' !important;
				position: absolute !important;
				inset: 11px !important;
				background: linear-gradient(
					140deg,
					color.adjust(tokens.$color-wax-seal, $lightness: -8%) 0%,
					color.adjust(tokens.$color-wax-seal, $lightness: -16%) 50%,
					color.adjust(tokens.$color-wax-seal, $lightness: -6%) 100%
				) !important;
				clip-path: polygon(48% 2%, 98% 24%, 100% 73%, 52% 98%, 2% 77%, 0% 27%) !important;
				box-shadow:
					inset 2px 2px 4px rgba(0, 0, 0, 0.5),
					inset -1px -1px 3px rgba(255, 255, 255, 0.1),
					inset 0 0 8px rgba(0, 0, 0, 0.2) !important;
				z-index: 1 !important;
			}

			&::before {
				display: none !important;
			}

			.seal-icon {
				width: 40px !important;
				height: 40px !important;
				z-index: 2 !important;
				color: rgba(0, 0, 0, 0.7) !important;
				mix-blend-mode: multiply;
				transform: rotate(-10deg);
				filter: drop-shadow(-1px -1px 0.5px rgba(0, 0, 0, 0.85))
					drop-shadow(0.75px 0.75px 0.3px rgba(255, 255, 255, 0.12));
				opacity: 0.9;
			}
		}
	}
}
